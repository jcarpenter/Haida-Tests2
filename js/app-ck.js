"use strict";var App=App||{};App.createNS=function(e){var t=e.split("."),n=App;t[0]==="App"&&(t=t.slice(1));for(var r=0;r<t.length;r++){var i=t[r];typeof n[i]=="undefined"&&(n[i]={});n=n[i]}return n};(function(e,t){e.init=function(){}})(App);App.createNS("ScreenManager");App.ScreenManager=function(){var e,t,n=document.getElementById("bottom-swipe"),r=document.getElementById("topleft-swipe"),i=document.getElementById("topright-swipe"),s=document.getElementById("status-bar"),o=document.getElementById("rocketbar-drawer"),u=document.getElementById("settings-drawer"),a=document.getElementById("keyboard");n.addEventListener("click",function(){console.log("-------swipe up-------");e?pubsubz.publish("close_topdrawer1"):t?pubsubz.publish("close_topdrawer2"):pubsubz.publish("open_bottomdrawer",App.Home.home_obj)});r.addEventListener("click",function(){e||t||pubsubz.publish("open_topdrawer1")});i.addEventListener("click",function(){e||t||pubsubz.publish("open_topdrawer2")});var f=function(){$(a).animo({animation:"showKeyboard",duration:.2,timing:"ease-out",keep:"true"})},l=function(){$(a).animo({animation:"hideKeyboard",duration:.2,timing:"ease-out",keep:"true"})},c=function(){f();$(s).animo({animation:"openFullRocketBar",duration:.2,timing:"ease-out",keep:"true"});$(o).children("#cursor").animo({animation:"blinking",duration:1,timing:"ease-out",iterate:"infinite"});$(o).children("#background").animo({animation:"darkenBG",duration:.3,timing:"ease-out",keep:"true"});o.classList.toggle("hidden");e=!0},h=function(){l();$(s).animo({animation:"closeFullRocketBar",duration:.2,timing:"ease-out"});$(o).animo({animation:"fadeOut",duration:.2,timing:"ease-out",keep:"true"},function(){$(o).animo("cleanse");$(o).children().animo("cleanse");o.classList.toggle("hidden");e=!1})},p=function(){$(u).animo({animation:"darkenBG",duration:.3,timing:"ease-out",keep:"true"});$(u).children("img").animo({animation:"slideInDown",duration:.3,timing:"ease-out",keep:"true"});u.classList.toggle("hidden");t=!0},d=function(){$(u).animo({animation:"lightenBG",duration:.3,timing:"ease-out",keep:"true"});$(u).children("img").animo({animation:"slideOutUp",duration:.3,timing:"ease-out"},function(){$(u).animo("cleanse");$(u).children("img").animo("cleanse");u.classList.toggle("hidden");t=!1})},v=function(e){this.name=e.name;this.id=e.id;this.number=e.number;this.type=e.type;this.chrome=e.chrome;var t=$("#Sheet").html(),n=Handlebars.compile(t),r=n(e);$(frame).append(r);this.html=$(frame).find(this.id+"_"+this.number)},m=function(e,t){var n=App.History.get_active_screen();if(t.id=="home"&&n.id=="undefined"){var r=new v(t);$.getJSON("js/preloads.json",function(e){$.each(e.preloads,function(e,t){App.Icon.make_icon(t)})});$(home).animo({animation:"flipInX",duration:1,timing:"ease-out"});App.History.set_active_screen(r)}else if(t.id=="home"&&n.id!="home"){$(n.html).removeClass("active_sheet");$(n.html).animo({animation:"closeSheet",duration:1,timing:"ease-out"},function(){$(n.html).animo("cleanse");$(n.html).addClass("inactive_sheet")});$(home).animo({animation:"flipInX",duration:1,timing:"ease-out"});App.History.set_active_screen(t)}else if(t.chrome=="site"&&n.chrome=="site")console.log("load site in current window");else{var r=new v(t);$(n.html).removeClass("active_sheet");$(t).addClass("active_sheet");$(r.html).animo({animation:"openSheet",duration:1,timing:"ease-out"});App.History.set_active_screen(r);console.log(r.html)}},g=function(){o.classList.toggle("hidden");u.classList.toggle("hidden")},y=pubsubz.subscribe("init",g),b=pubsubz.subscribe("open_bottomdrawer",m),w=pubsubz.subscribe("open_topdrawer1",c),E=pubsubz.subscribe("close_topdrawer1",h),S=pubsubz.subscribe("open_topdrawer2",p),x=pubsubz.subscribe("close_topdrawer2",d),T=pubsubz.subscribe("open_sheet",m);return{}}();App.createNS("History");App.History=function(){var e={},t=[],n=[],r=function(t){e=t},i=function(){return e},s=function(){console.log(t.length);console.log(n.length)};return{set_active_screen:r,get_active_screen:i,history_list:t,update_count:s}}();App.createNS("Home");App.Home=function(){var e={name:"Home",id:"home",number:0},t=function(){pubsubz.publish("open_sheet",e)},n=pubsubz.subscribe("init",t);return{home_obj:e}}();App.createNS("Icon");App.Icon=function(e){var t=function(e){this.name=e.name;this.id=e.id;this.number=e.number;this.type=e.type;this.chrome=e.chrome;var t=$("#appIcon").html(),n=Handlebars.compile(t),r=n(e);$(home).append(r);this.html=$(home).find("#icon_"+this.id)},n=function(e){var n=new t(e);App.BookmarkList.add_new(n);$(n.html).click(function(){pubsubz.publish("open_sheet",n)})};return{make_icon:n}}();App.createNS("Bookmarks");App.BookmarkList=function(){var e=[],t=function(t){e.push(t)};return{add_new:t,list:e}}();pubsubz.publish("init");